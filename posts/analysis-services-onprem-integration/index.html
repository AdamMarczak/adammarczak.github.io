<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en-us">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Azure Analysis Services hybrid enrivonment with on-premises databases | Marczak.IO | Adam Marczak</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/png" href="https://marczak.io/images/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="https://marczak.io/images/favicon-16x16.png" sizes="16x16" />
<link rel="apple-touch-icon-precomposed" href="https://marczak.io/images/iphone-icon.png"/>
<link rel="stylesheet" id="hestia_fonts-css" href="https://fonts.googleapis.com/css?family=Roboto%3A300%2C400%2C500%2C700%7CRoboto+Slab%3A400%2C700&amp;subset=latin%2Clatin-ext" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css" media="all">
<link href='https://marczak.io/css/hestia.min.css?ver=1.23' rel="stylesheet" type="text/css" />
<link href='https://marczak.io/css/main.min.css?ver=1.25' rel='stylesheet' type="text/css" />

<meta name="description" content="Integration with on premises environments is one of more common cloud scenarios. Learn how to set up and Analysis Services hybrid environment with use of On-Premises Data Gateway. ">
<meta name="author" content="Adam Marczak">
<meta name="copyright" content="Adam Marczak">
<meta name="title" content="Azure Analysis Services hybrid enrivonment with on-premises databases | Marczak.IO | Adam Marczak">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="https://www.facebook.com/MarczakIO/">
<meta property="og:type" content="article">
<meta property="og:title" content="Azure Analysis Services hybrid enrivonment with on-premises databases">
<meta property="og:description" content="Integration with on premises environments is one of more common cloud scenarios. Learn how to set up and Analysis Services hybrid environment with use of On-Premises Data Gateway. ">
<meta property="og:url" content="https://marczak.io/posts/analysis-services-onprem-integration/">
<meta property="og:site_name" content="Marczak.IO">
<meta property="og:image" content="https://marczak.io/images/analysis-services-onprem-integration/splash.png">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@MarczakIO">
<meta name="twitter:title" content="Azure Analysis Services hybrid enrivonment with on-premises databases">
<meta name="twitter:description" content="Integration with on premises environments is one of more common cloud scenarios. Learn how to set up and Analysis Services hybrid environment with use of On-Premises Data Gateway. ">
<meta name="twitter:url" content="https://marczak.io/posts/analysis-services-onprem-integration/">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106560028-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());
  gtag('config', 'UA-106560028-1');
</script>
</head>
<body class="home blog">
  <div class="wrapper"><header class="header">
  <nav class="navbar navbar-default hestia_left">
    <div class="container">
      <div class="navbar-header">
        <div class="title-logo-wrapper">
          <a class="navbar-brand" href="/" title="Marczak.IO">
            <p>Marczak.IO</p>
          </a>
        </div>
      </div>
      <div id="main-navigation" class="navbar-custom">
        <div class="entry-social">
  <a target="_top" class="btn btn-just-icon btn-social btn-social-mail"
     href="mailto:adam@marczak.io">
    <i class="fa fa-envelope"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-facebook"
     href="https://www.facebook.com/MarczakIO/">
    <i class="fa fa-facebook"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-twitter"
     href="https://twitter.com/MarczakIO">
    <i class="fa fa-twitter"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-linkedin"
     href="https://www.linkedin.com/in/adam-marczak-96088929/">
    <i class="fa fa-linkedin"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-youtube"
     href="https://www.youtube.com/azure4everyone">
    <i class="fa fa-youtube"></i>
  </a>
  <a target="_top" class="btn btn-friendly-site " 
      style=""
      href="https://azure4everyone.com">
      <img src="https://marczak.io/images/azure4everyone.svg">
      <span>Azure 4 Everyone</span>
  </a>
</div>
      </div>
    </div>
  </nav>
  <div id="primary" class="boxed-layout-header page-header header-small" data-parallax="active" style="margin-top: -20px;">
    <div class="container">
      <div class="row">
        <div class="col-md-10 col-md-offset-1 text-center">
          <h1 class="hestia-title">Azure Analysis Services hybrid enrivonment with on-premises databases</h1>
          
            <h4 class="author">
              Published by<a href="/about" title="Adam Marczak" class="vcard author"><strong class="fn">Adam Marczak</strong></a> on <time class="date updated published" datetime="2018-06-26 18:00:23 &#43;0200 CEST">Jun 26 2018</time>
            </h4>
           
        </div>
      </div>
    </div>
    <div class="header-filter" style="background-image: url('/images/background.jpg');background-color: #283743;"></div>
  </div>
</header>
    <div class="main main-raised">
      <div class="hestia-blogs">
        <div class="container">
          <div class="row">
<div class="col-md-9 single-posts-wrap">
    <article id="/posts/analysis-services-onprem-integration/" class="article-section section-text"> 
<div class="lazy" style="max-height: 433px">
    <div style="padding-bottom:56.380208333333336%"></div>
    <img data-src="/images/analysis-services-onprem-integration/splash.png" src=""/> 
</div> <a target="_blank" 
   rel="tooltip" 
   class="btn btn-github"
   href="https://github.com/MarczakIO/analysis-services-onprem-integration">
    <i class="fa fa-github"></i>
    Source Code
</a>
        <h2>Highlight</h2>
        <p>Integration with on premises environments is one of more common cloud scenarios. Learn how to set up and Analysis Services hybrid environment with use of On-Premises Data Gateway. </p>

<h2 id="intro">Intro</h2>

<p>Building Analysis Services model which uses on premises databases might be confusing in the beginning. In reality it takes less than one hour to create end to end setup using out of the box components available to developers.</p>

<p>This article will cover</p>

<ol>
<li>Azure environment setup</li>
<li>On premises data gateway setup<br /></li>
<li>Visual Studio model which connects live to on premises database</li>
<li>Model deployment</li>
</ol>

<h3 id="prerequisites">Prerequisites</h3>

<p>Following tools are required to execute this tutorial</p>

<ol>
<li>Azure Subscription</li>
<li>Visual Studio 2017</li>
<li>SQL Server Data Tools 2017</li>
<li>On premises environment with SQL Server installed.</li>
</ol>

<p>Note: On premises environment can be simulated using Azure Dev Test lab VM. I strongly suggest installing fresh Windows 7 VM and follow steps in On Premises setup section.</p>

<h2 id="design">Design</h2>

<p>Presented design will be focus of this article. </p>


<div class="lazy" style="max-height: 158px">
    <div style="padding-bottom:19.29181929181929%"></div>
    <img data-src="/images/analysis-services-onprem-integration/1.png" src=""/> 
</div>  

<h4 id="components">Components</h4>

<ol>
<li>On-Premises

<ol>
<li><strong>SQL Server database</strong> - source of data</li>
<li><strong>On-Premises Data Gateway installation</strong> - windows service used for connectivity</li>
</ol></li>
<li>Azure

<ol>
<li><strong>On-Premises Data Gateway resource</strong> - azure resource used for binding local gateway</li>
<li><strong>Azure Analysis Services</strong> - consumer of live query data from sql server</li>
</ol></li>
</ol>

<h2 id="on-premises-demo-setup-optional">On-Premises demo setup (optional)</h2>

<p>Article uses SQL server as example of on premises database. This installation has been fully done on Azure DevTest Labs.</p>

<p>If environment preparation is required, then follow below steps otherwise move to next section.</p>

<ol>
<li>Create DevTest Lab environment

<div class="lazy" style="max-height: 196px">
    <div style="padding-bottom:33.56164383561644%"></div>
    <img data-src="/images/analysis-services-onprem-integration/2.png" src=""/> 
</div>  </li>
<li>For the parameters fill

<ul>
<li><strong>Lab Name</strong>: Provide any</li>
<li><strong>Location</strong>: North Europe (choose one region and stick with it for entire setup)</li>
</ul></li>
<li>Once provisioned go to lab and click on Add new

<div class="lazy" style="max-height: 102px">
    <div style="padding-bottom:17.555938037865747%"></div>
    <img data-src="/images/analysis-services-onprem-integration/3.png" src=""/> 
</div>  </li>
<li>Select Windows 10 Enterprise VM image</li>
<li>Fill VM form fields

<div class="lazy" style="max-height: 619px">
    <div style="padding-bottom:187.57575757575756%"></div>
    <img data-src="/images/analysis-services-onprem-integration/4.png" src=""/> 
</div>  

<ul>
<li><strong>Virtual Machine Name</strong>: devtestlab001, name is important when connecting to SQL server later on. Any name works though.</li>
<li><strong>User Name</strong>: Any will do, this will be used to log into machine.</li>
<li><strong>Password</strong>: Any will do, this will be used to log into machine.</li>
<li><strong>Disk and size</strong>: SSD</li>
<li><strong>VM Size</strong>: I choose D4s_v3 but any works fine. Small VMs just take much longer to run programs.</li>
<li><strong>Artifacts</strong>: Chrome.</li>
</ul></li>
<li>Connect to VM

<div class="lazy" style="max-height: 128px">
    <div style="padding-bottom:27.467811158798284%"></div>
    <img data-src="/images/analysis-services-onprem-integration/5.png" src=""/> 
</div>  </li>
<li>Install following tools

<ol>
<li><a href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads">SQL Server Developer Edition</a>

<div class="lazy" style="max-height: 660px">
    <div style="padding-bottom:79.23169267707082%"></div>
    <img data-src="/images/analysis-services-onprem-integration/6.png" src=""/> 
</div>  </li>
<li><a href="https://docs.microsoft.com/en-us/sql/ssdt/download-sql-server-data-tools-ssdt?view=sql-server-2017">SQL Server Data Tools</a>

<div class="lazy" style="max-height: 534px">
    <div style="padding-bottom:69.26070038910505%"></div>
    <img data-src="/images/analysis-services-onprem-integration/7.png" src=""/> 
</div>  </li>
<li><a href="https://visualstudio.microsoft.com/vs/community/">Visual Studio Community</a>
Make Sure to select Data and storage tools.

<div class="lazy" style="max-height: 96px">
    <div style="padding-bottom:22.857142857142858%"></div>
    <img data-src="/images/analysis-services-onprem-integration/8.png" src=""/> 
</div>  </li>
</ol></li>
<li>Open Visual Studio</li>
<li>Open SQL Server Object Explorer. If it is not visible, it can be enabled in View options.</li>
<li>Connect to local SQL database

<div class="lazy" style="max-height: 147px">
    <div style="padding-bottom:47.88273615635179%"></div>
    <img data-src="/images/analysis-services-onprem-integration/9.png" src=""/> 
</div>  </li>
<li>Select local instance (should have the same name as VM name)

<div class="lazy" style="max-height: 588px">
    <div style="padding-bottom:122.24532224532224%"></div>
    <img data-src="/images/analysis-services-onprem-integration/10.png" src=""/> 
</div>  </li>
<li>Open new query

<div class="lazy" style="max-height: 264px">
    <div style="padding-bottom:83.28075709779179%"></div>
    <img data-src="/images/analysis-services-onprem-integration/11.png" src=""/> 
</div>  </li>
<li>Run Query to Setup demo database
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">database</span> <span class="n">asdemodb</span><span class="p">;</span>
<span class="k">GO</span>

<span class="n">use</span> <span class="n">asdemodb</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">MyData</span> <span class="p">(</span>
	<span class="n">Id</span> <span class="nb">int</span> <span class="k">identity</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
	<span class="n">FirstName</span> <span class="n">nvarchar</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
	<span class="n">LastName</span> <span class="n">nvarchar</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span>
<span class="p">)</span>
<span class="k">GO</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">MyData</span> <span class="p">(</span><span class="n">FirstName</span><span class="p">,</span> <span class="n">LastName</span><span class="p">)</span>
<span class="k">VALUES</span> 
	<span class="p">(</span><span class="s1">&#39;Adam&#39;</span><span class="p">,</span><span class="s1">&#39;Doe&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Meghan&#39;</span><span class="p">,</span> <span class="s1">&#39;Green&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Jerry&#39;</span><span class="p">,</span> <span class="s1">&#39;Hansen&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Gerardo&#39;</span><span class="p">,</span> <span class="s1">&#39;Mcgee&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Dan&#39;</span><span class="p">,</span> <span class="s1">&#39;Burke&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Juan&#39;</span><span class="p">,</span> <span class="s1">&#39;Harmon&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Doris&#39;</span><span class="p">,</span> <span class="s1">&#39;Brady&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Marcos&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanley&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Candace&#39;</span><span class="p">,</span> <span class="s1">&#39;Stevens&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Kelli&#39;</span><span class="p">,</span> <span class="s1">&#39;Watts&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Sherry&#39;</span><span class="p">,</span> <span class="s1">&#39;Gutierrez&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Jana&#39;</span><span class="p">,</span> <span class="s1">&#39;Osborne&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Sonja&#39;</span><span class="p">,</span> <span class="s1">&#39;Lucas&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Charlotte&#39;</span><span class="p">,</span> <span class="s1">&#39;Clarke&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Clifford&#39;</span><span class="p">,</span> <span class="s1">&#39;Webb&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Marguerite&#39;</span><span class="p">,</span> <span class="s1">&#39;Andrews&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Luther&#39;</span><span class="p">,</span> <span class="s1">&#39;Burgess&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Joey&#39;</span><span class="p">,</span> <span class="s1">&#39;Conner&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Tonya&#39;</span><span class="p">,</span> <span class="s1">&#39;Mullins&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Grant&#39;</span><span class="p">,</span> <span class="s1">&#39;Patton&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Elmer&#39;</span><span class="p">,</span> <span class="s1">&#39;Dean&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Alton&#39;</span><span class="p">,</span> <span class="s1">&#39;Gonzales&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Wesley&#39;</span><span class="p">,</span> <span class="s1">&#39;Daniel&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Salvador&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Lana&#39;</span><span class="p">,</span> <span class="s1">&#39;Newman&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;Gabriel&#39;</span><span class="p">,</span> <span class="s1">&#39;Reeves&#39;</span><span class="p">)</span>
<span class="p">;</span>
<span class="k">GO</span></code></pre></div>
Output
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="p">(</span><span class="mi">26</span> <span class="k">row</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">affected</span><span class="p">)</span></code></pre></div></li>
</ol>

<h2 id="install-on-premises-gateway">Install On-Premises Gateway</h2>

<ol>
<li>Download &amp; Run <a href="https://aka.ms/azureasgateway">On-Premises Data Gateway</a></li>
<li>When prompted log into Azure using the same account that will be setting up Azure Resources.

<ul>
<li><strong>Important</strong>: Personal account can&rsquo;t be used, this must be work account. In case of personal MSDN subscription go to Azure and create static user and grant him privileges go execute this scenario (resource group owner is enough).</li>
</ul></li>
<li>Select register a new gateway option

<div class="lazy" style="max-height: 245px">
    <div style="padding-bottom:45.370370370370374%"></div>
    <img data-src="/images/analysis-services-onprem-integration/12.png" src=""/> 
</div>  </li>
<li>Give it a recognizable name and type in recovery key. Make sure to back up this key.

<div class="lazy" style="max-height: 305px">
    <div style="padding-bottom:50.91819699499165%"></div>
    <img data-src="/images/analysis-services-onprem-integration/13.png" src=""/> 
</div>  </li>
<li>Finish installation and verify status. Properly working gateway should show <em>Ready</em> status

<div class="lazy" style="max-height: 518px">
    <div style="padding-bottom:82.74760383386581%"></div>
    <img data-src="/images/analysis-services-onprem-integration/14.png" src=""/> 
</div>  </li>
</ol>

<h2 id="provision-azure-resources">Provision Azure Resources</h2>

<ol>
<li>Create new Analysis Services resource

<div class="lazy" style="max-height: 469px">
    <div style="padding-bottom:141.26506024096386%"></div>
    <img data-src="/images/analysis-services-onprem-integration/15.png" src=""/> 
</div>  

<ul>
<li><strong>Server Name</strong> unique name for Analysis Services instance</li>
<li><strong>Resource Group</strong> select previously created resource group (new also works)</li>
<li><strong>Pricing Tier</strong> choose capacity, in this example B2 was used for faster responses</li>
<li><strong>Location</strong> North Europe (or the same as the lab for low latency)</li>
</ul></li>
<li>Create new On-premises data gateway resource

<div class="lazy" style="max-height: 199px">
    <div style="padding-bottom:67.45762711864407%"></div>
    <img data-src="/images/analysis-services-onprem-integration/16.png" src=""/> 
</div>  

<div class="lazy" style="max-height: 557px">
    <div style="padding-bottom:171.3846153846154%"></div>
    <img data-src="/images/analysis-services-onprem-integration/17.png" src=""/> 
</div>  

<ul>
<li><strong>Resource Name</strong> name for gateway resource</li>
<li><strong>Resource Group</strong> select previously created resource group</li>
<li><strong>Location</strong> same as analysis services. This is important!</li>
<li><strong>Installation Name</strong> select from dropdown previously created and installed gateway</li>
</ul></li>
<li>Open Analysis Services resource</li>
<li>Open On-premises data gateway blade

<div class="lazy" style="max-height: 152px">
    <div style="padding-bottom:69.0909090909091%"></div>
    <img data-src="/images/analysis-services-onprem-integration/18.png" src=""/> 
</div>  </li>
<li>Connect gateway by providing previously created region and gateway resource

<div class="lazy" style="max-height: 238px">
    <div style="padding-bottom:72.5609756097561%"></div>
    <img data-src="/images/analysis-services-onprem-integration/19.png" src=""/> 
</div>  </li>
<li>Successful connection will be indicated by checkmark

<div class="lazy" style="max-height: 251px">
    <div style="padding-bottom:81.22977346278317%"></div>
    <img data-src="/images/analysis-services-onprem-integration/20.png" src=""/> 
</div>  </li>
</ol>

<h2 id="deploy-model">Deploy Model</h2>

<p>Before deployment model connect again to the database and grant Power BI gateway service access to the database. This will be required when Analysis Services tries to connect using gateway.</p>

<ol>
<li>Open New Query with the database</li>
<li>Execute below script
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">use</span> <span class="n">master</span><span class="p">;</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="n">LOGIN</span> <span class="p">[</span><span class="n">NT</span> <span class="n">Service</span><span class="err">\</span><span class="n">PBIEgwService</span><span class="p">]</span> <span class="k">FROM</span> <span class="n">WINDOWS</span><span class="p">;</span>  
<span class="k">GO</span> 

<span class="n">use</span> <span class="n">asdemodb</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">USER</span> <span class="p">[</span><span class="n">NT</span> <span class="n">Service</span><span class="err">\</span><span class="n">PBIEgwService</span><span class="p">]</span> <span class="k">for</span> <span class="n">login</span> <span class="p">[</span><span class="n">NT</span> <span class="n">Service</span><span class="err">\</span><span class="n">PBIEgwService</span><span class="p">]</span>
<span class="k">GO</span>

<span class="k">EXEC</span> <span class="n">sp_addrolemember</span> <span class="n">db_datareader</span><span class="p">,</span> <span class="p">[</span><span class="n">NT</span> <span class="n">Service</span><span class="err">\</span><span class="n">PBIEgwService</span><span class="p">];</span>
<span class="k">GO</span></code></pre></div>

<ul>
<li>Note: NT Service\PBIEgwService is the name of the local service under which by default gateway is running.</li>
</ul></li>
</ol>

<p>Now follow the steps</p>

<ol>
<li>Open Visual Studio</li>
<li>Create new Tabular project

<div class="lazy" style="max-height: 648px">
    <div style="padding-bottom:69.3048128342246%"></div>
    <img data-src="/images/analysis-services-onprem-integration/21.png" src=""/> 
</div>  

<ul>
<li><strong>Note</strong> If project template is missing verify if Sql Server data tools are correctly installed.</li>
<li><strong>Instance</strong> select Integrated Workspace</li>
<li><strong>Compatibility Level</strong> choose SQL Server 2017 / Azure Analysis Services (1400), this will allow you to use newest features including Query Editor like in Power BI and Excel Power Query.</li>
</ul></li>
<li>In the Solution Explorer of project right-click on the Data Sources and select Import from data source option

<div class="lazy" style="max-height: 211px">
    <div style="padding-bottom:47.20357941834452%"></div>
    <img data-src="/images/analysis-services-onprem-integration/22.png" src=""/> 
</div>  </li>
<li>Select SQL server database as the data source

<div class="lazy" style="max-height: 636px">
    <div style="padding-bottom:109.46643717728055%"></div>
    <img data-src="/images/analysis-services-onprem-integration/23.png" src=""/> 
</div>  </li>
<li>Type in database details from previous steps

<div class="lazy" style="max-height: 253px">
    <div style="padding-bottom:87.24137931034483%"></div>
    <img data-src="/images/analysis-services-onprem-integration/24.png" src=""/> 
</div>  </li>
<li>Select connection credentials as Impersonate Service Account

<div class="lazy" style="max-height: 145px">
    <div style="padding-bottom:28.76984126984127%"></div>
    <img data-src="/images/analysis-services-onprem-integration/25.png" src=""/> 
</div>  </li>
<li>Verify data and click Load

<div class="lazy" style="max-height: 666px">
    <div style="padding-bottom:78.07737397420867%"></div>
    <img data-src="/images/analysis-services-onprem-integration/26.png" src=""/> 
</div>  </li>
<li>Successfully loaded model should appear in the designer

<div class="lazy" style="max-height: 595px">
    <div style="padding-bottom:174.4868035190616%"></div>
    <img data-src="/images/analysis-services-onprem-integration/27.png" src=""/> 
</div>  </li>
<li>In the Tabular Model Explorer right-click on the Model.bim file and select properties</li>
<li>Change parameter DirectQyert Mode from Off to On

<div class="lazy" style="max-height: 322px">
    <div style="padding-bottom:92.26361031518624%"></div>
    <img data-src="/images/analysis-services-onprem-integration/28.png" src=""/> 
</div>  </li>
<li>Navigate back to Azure Analysis Service and in the Overview blade copy Server name

<div class="lazy" style="max-height: 87px">
    <div style="padding-bottom:20.422535211267604%"></div>
    <img data-src="/images/analysis-services-onprem-integration/29.png" src=""/> 
</div>  </li>
<li>In the Tabular Model Explorer right-click on the ModelProject project file and select Properties option</li>
<li>Paste in copied AAS in the server address property field

<div class="lazy" style="max-height: 250px">
    <div style="padding-bottom:32.808398950131235%"></div>
    <img data-src="/images/analysis-services-onprem-integration/30.png" src=""/> 
</div>  </li>
<li>Again right-click on the ModelProject project file and select Deploy option

<div class="lazy" style="max-height: 98px">
    <div style="padding-bottom:23.6144578313253%"></div>
    <img data-src="/images/analysis-services-onprem-integration/31.png" src=""/> 
</div>  </li>
<li>Successful deployment should look like this

<div class="lazy" style="max-height: 239px">
    <div style="padding-bottom:42.30088495575221%"></div>
    <img data-src="/images/analysis-services-onprem-integration/32.png" src=""/> 
</div>  </li>
<li>Navigate back to Azure Analysis Service and in the Overview blade click on the Web Designer Open button

<div class="lazy" style="max-height: 40px">
    <div style="padding-bottom:20.304568527918782%"></div>
    <img data-src="/images/analysis-services-onprem-integration/33.png" src=""/> 
</div>  </li>
<li>Click on the &lsquo;eye&rsquo; icon in the Models panel

<div class="lazy" style="max-height: 292px">
    <div style="padding-bottom:41.77396280400572%"></div>
    <img data-src="/images/analysis-services-onprem-integration/34.png" src=""/> 
</div>  </li>
<li>Select &lsquo;Show DAX&rsquo; and paste in the script
<div class="highlight"><pre class="chroma"><code class="language-DAX" data-lang="DAX">EVALUATE (
  TOPN (
    3000,
    SUMMARIZECOLUMNS (
      &#39;MyData&#39;[Id],
      &#39;MyData&#39;[LastName],
      &#39;MyData&#39;[FirstName]
    ),
    &#39;MyData&#39;[Id],
    1
  )
)</code></pre></div></li>
<li>Verify results

<div class="lazy" style="max-height: 746px">
    <div style="padding-bottom:39.07805133577789%"></div>
    <img data-src="/images/analysis-services-onprem-integration/35.png" src=""/> 
</div>  
Change results in the database to demo out live connection</li>
</ol>

<h2 id="summary">Summary</h2>

<p>A careful reader should by now understand and be able to execute following activities</p>

<ul>
<li>Settings up dev test lab to imitate on premises environment</li>
<li>Grating permissions to services in SQL server</li>
<li>Creating Azure Analysis Services</li>
<li>Connecting &amp; querying Azure Analysis Services using Query Editor</li>
<li>Creating simple Analysis Services model</li>
<li>Configuring and deployment Analysis Services models</li>
<li>Configuring and integrating On-premises data gateway with Azure Analysis Services</li>
</ul><a target="_blank" 
   rel="tooltip" 
   class="btn btn-github"
   href="https://github.com/MarczakIO/analysis-services-onprem-integration">
    <i class="fa fa-github"></i>
    Source Code
</a>
    </article>
    <div class="section-blog-info">
        <div class="row">
            <div class="col-md-12">
<div class="authorblock">
    <div class="row">
        <div class="col-sm-3">
            <div class="avatar"></div>
        </div>
        <div class="col-sm-9">
            <h4><b>Adam Marczak</b></h4>
            <p>Programmer, architect, trainer, blogger, evangelist are just a few of many titles. What I really am, is a passionate technology enthusiast. I take great pleasure in learning new technologies and finding ways in which it can aid people every day. My latest passion is running an <a href='https://www.youtube.com/azure4everyone'>Azure 4 Everyone</a> YouTube channel, where I show that Azure really is for everyone!</p>
        </div>
    </div>
</div>
            </div>
        </div> 
        <div class="row">
            <div class="col-md-12 text-center">
                <h3 class="text-center">Did you enjoy the article?</h3>
            </div>
            <div class="col-md-6 text-center">
                <h4 class="">Share it!</h4><a target="_blank" 
   rel="tooltip" 
   data-original-title="Share on Facebook" 
   class="btn btn-just-icon btn-share btn-facebook"
   href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmarczak.io%2fposts%2fanalysis-services-onprem-integration%2f">
    <i class="fa fa-facebook"></i>
</a>
<a target="_blank" 
   rel="tooltip" 
   data-original-title="Share on Twitter" 
   class="btn btn-just-icon btn-share btn-twitter" 
   href="https://twitter.com/home?status=Azure%20Analysis%20Services%20hybrid%20enrivonment%20with%20on-premises%20databases - https%3a%2f%2fmarczak.io%2fposts%2fanalysis-services-onprem-integration%2f">
   <i class="fa fa-twitter"></i>
</a>
<a target="_blank" 
   rel="tooltip" 
   data-original-title="Share on Google+" 
   class="btn btn-just-icon btn-share btn-google" 
   href="https://plus.google.com/share?url=https%3a%2f%2fmarczak.io%2fposts%2fanalysis-services-onprem-integration%2f"><i 
   class="fa fa-google"></i>
</a>
            
            </div>
            <div class="col-md-6 text-center large">
                <h4 class="">More tagged posts</h4>
  <div class="tag-list">
    <a href="https://marczak.io/tags/analysis-services" title="View all posts in Analysis Services">
      <img src="https://marczak.io/images/tags/analysis-services.svg" alt="Analysis Services"/>
    </a>
    <a href="https://marczak.io/tags/azure" title="View all posts in Azure">
      <img src="https://marczak.io/images/tags/azure.svg" alt="Azure"/>
    </a>
    <a href="https://marczak.io/tags/data-gateway" title="View all posts in Data gateway">
      <img src="https://marczak.io/images/tags/data-gateway.svg" alt="Data gateway"/>
    </a>
    <a href="https://marczak.io/tags/sql" title="View all posts in SQL">
      <img src="https://marczak.io/images/tags/sql.svg" alt="SQL"/>
    </a>
    <a href="https://marczak.io/tags/visual-studio" title="View all posts in Visual Studio">
      <img src="https://marczak.io/images/tags/visual-studio.svg" alt="Visual Studio"/>
    </a>
  </div>
            </div>
        </div>
        <div class="row comments">
            <div class="col-md-12"><div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "https:\/\/marczak.io\/posts\/analysis-services-onprem-integration\/"; 
this.page.identifier = "\/posts\/analysis-services-onprem-integration\/";
};

(function() {
if (window.location.hostname == "localhost")return;
var d = document, s = d.createElement('script');
s.src = 'https://marczak-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
            </div>
        </div> 
    </div>
</div>
            <div class="col-md-3 blog-sidebar-wrapper">
              <aside id="secondary" class="blog-sidebar" role="complementary"><div id="mvp" class="banner-mvp">
<img src="/images/mvp.svg" />
</div><div id="recent-posts" class="recent-posts widget widget_recent_entries" style="float:left;margin-right:10px;">
<h5>Featured Courses</h5>
<div style="width:180px;margin-top:25px">
<div style="margin-top:10px">
    <a href="https://marczak.io/az-900" >
        <img src="/images/az-900/cert.svg" style="width:60px;margin-right:10px;;float:left;"></img> AZ-900 <br/>Microsoft Azure Fundamentlas
    </a>
</div>
</div>
</div><div id="recent-posts" class="recent-posts widget widget_recent_entries">
<h5>Featured Videos</h5>
<div style="width:180px;margin-top:10px">

<p style="font-weight:normal">Process Excel files in Azure</p>
<div style="margin-top:10px;">
    <a href="https://youtu.be/pc8Kv-lRD8k" > 
<div class="lazy" style="max-height: 416px">
    <div style="padding-bottom:56.21621621621622%"></div>
    <img data-src="/images/youtube/49-AzureExcelFileProcessing-ADFandDatabricks-Tutorial-740.jpg" src=""/> 
</div> 
    </a>
</div>

</div>
<div style="width:180px;margin-top:10px">

<p style="font-weight:normal">AZ-900 Full Course</p>
<div style="margin-top:10px;">
    <a href="https://youtu.be/NPEsD6n9A_I" > 
<div class="lazy" style="max-height: 416px">
    <div style="padding-bottom:56.21621621621622%"></div>
    <img data-src="/images/az-900/az-900-ep-00-740.jpg" src=""/> 
</div> 
    </a>
</div>

</div>
<div style="width:180px;margin-top:10px">

<p style="font-weight:normal">Azure Active Directory Tutorial</p>
<div style="margin-top:10px;">
    <a href="https://youtu.be/Ma7VAQE7ga4" > 
<div class="lazy" style="max-height: 416px">
    <div style="padding-bottom:56.21621621621622%"></div>
    <img data-src="/images/youtube/48-AzureActiveDirectory-Intro-740.jpg" src=""/> 
</div> 
    </a>
</div>

</div>
</div><div id="recent-posts" class="recent-posts widget widget_recent_entries" style="float:left;margin-right:10px;">
</div><div id="recent-posts" class="recent-posts widget widget_recent_entries" style="float:left;max-width:180px;margin-right:30px;">
<h5>Recent Posts</h5>
<ul>
        <li><b class="list-header">2020 July</b></li>
        <li class="indented">
            <a href="/posts/2020/07/az-900-full-course/" title="AZ-900 Microsoft Azure Fundamentals full course" rel="bookmark">
                <b>7th </b>AZ-900 Microsoft Azure Fundamentals full course
            </a>
        </li>
        <li><b class="list-header">2019 October</b></li>
        <li class="indented">
            <a href="/posts/2019/10/ea-consumption-automation-with-logic-apps/" title="Automating Enterprise Azure billing using Logic Apps for 0.03$/month" rel="bookmark">
                <b>25th </b>Automating Enterprise Azure billing using Logic Apps for 0.03$/month
            </a>
        </li>
        <li><b class="list-header">2019 August</b></li>
        <li class="indented">
            <a href="/posts/2019/08/logic-apps-obfuscation/" title="Enhancing Logic Apps security with obfuscation" rel="bookmark">
                <b>16th </b>Enhancing Logic Apps security with obfuscation
            </a>
        </li>
        <li class="indented">
            <a href="/posts/2019/08/secure-logic-app-with-api-management/" title="Securing Logic App with Azure AD authentication using API Management" rel="bookmark">
                <b>8th </b>Securing Logic App with Azure AD authentication using API Management
            </a>
        </li>
        <li><b class="list-header">2019 July</b></li>
        <li class="indented">
            <a href="/posts/2019/07/securing-websites-with-msi/" title="Securing Azure Services with Managed Identities" rel="bookmark">
                <b>19th </b>Securing Azure Services with Managed Identities
            </a>
        </li>
</ul>
</div><div id="categories-3" class="widget widget_categories" style="float: left;">
  <h5>Tags</h5>
  <ul class="tag-list">
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/active-directory.svg" alt="Active Directory"/> 
        </div> 
        <a href="https://marczak.io/tags/active-directory">Active Directory (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/analysis-services.svg" alt="Analysis Services"/> 
        </div> 
        <a href="https://marczak.io/tags/analysis-services">Analysis Services (3)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/api-management.svg" alt="Api Management"/> 
        </div> 
        <a href="https://marczak.io/tags/api-management">Api Management (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/app-service.svg" alt="App Service"/> 
        </div> 
        <a href="https://marczak.io/tags/app-service">App Service (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/azure.svg" alt="Azure"/> 
        </div> 
        <a href="https://marczak.io/tags/azure">Azure (17)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/bot-service.svg" alt="Bot Service"/> 
        </div> 
        <a href="https://marczak.io/tags/bot-service">Bot Service (5)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/cognitive-services.svg" alt="Cognitive Services"/> 
        </div> 
        <a href="https://marczak.io/tags/cognitive-services">Cognitive Services (2)</a>
      </li>
      <li class="child"> 
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/luis.svg" alt="Luis"/> 
        </div> 
        <a href="https://marczak.io/tags/luis">Luis (1)</a>
      </li>
      <li class="child"> 
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/text-analytics.svg" alt="Text Analytics"/> 
        </div> 
        <a href="https://marczak.io/tags/text-analytics">Text Analytics (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/cosmos-db.svg" alt="Cosmos Db"/> 
        </div> 
        <a href="https://marczak.io/tags/cosmos-db">Cosmos Db (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/data-factory.svg" alt="Data Factory"/> 
        </div> 
        <a href="https://marczak.io/tags/data-factory">Data Factory (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/data-gateway.svg" alt="Data Gateway"/> 
        </div> 
        <a href="https://marczak.io/tags/data-gateway">Data Gateway (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/dotnet-core.svg" alt="Dotnet Core"/> 
        </div> 
        <a href="https://marczak.io/tags/dotnet-core">Dotnet Core (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/flow.svg" alt="Flow"/> 
        </div> 
        <a href="https://marczak.io/tags/flow">Flow (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/functions.svg" alt="Functions"/> 
        </div> 
        <a href="https://marczak.io/tags/functions">Functions (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/key-vault.svg" alt="Key Vault"/> 
        </div> 
        <a href="https://marczak.io/tags/key-vault">Key Vault (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/logic-apps.svg" alt="Logic Apps"/> 
        </div> 
        <a href="https://marczak.io/tags/logic-apps">Logic Apps (7)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/security.svg" alt="Security"/> 
        </div> 
        <a href="https://marczak.io/tags/security">Security (3)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/sql.svg" alt="Sql"/> 
        </div> 
        <a href="https://marczak.io/tags/sql">Sql (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/teams.svg" alt="Teams"/> 
        </div> 
        <a href="https://marczak.io/tags/teams">Teams (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/visual-studio.svg" alt="Visual Studio"/> 
        </div> 
        <a href="https://marczak.io/tags/visual-studio">Visual Studio (3)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/visual-studio-code.svg" alt="Visual Studio Code"/> 
        </div> 
        <a href="https://marczak.io/tags/visual-studio-code">Visual Studio Code (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/vue.js.svg" alt="Vue.js"/> 
        </div> 
        <a href="https://marczak.io/tags/vue.js">Vue.js (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/webpack.svg" alt="Webpack"/> 
        </div> 
        <a href="https://marczak.io/tags/webpack">Webpack (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/youtube.svg" alt="Youtube"/> 
        </div> 
        <a href="https://marczak.io/tags/youtube">Youtube (1)</a>
      </li>
  </ul>
</div><div id="recent-posts" class="recent-posts widget widget_recent_entries" style="float:left;margin-right:10px;">
<h5>Featured Sites</h5>
<div style="width:180px;margin-top:25px">
<div style="margin-top:10px;">
    <a href="https://sqlplayer.net" > 
<div class="lazy" style="max-height: 270px">
    <div style="padding-bottom:28.481012658227847%"></div>
    <img data-src="/images//sites/sql-player.png" src=""/> 
</div> 
    </a>
</div>
</div>
</div>
              </aside>
            </div>
          </div>
        </div>
      </div>
<footer class="footer footer-black footer-big">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h5 class="connected-title">Stay Connected</h5>
                <div class="">
  <a target="_top" class="btn btn-just-icon btn-social-small btn-social-about"
     href="/about">
    <i class="fa fa-user"></i>
  </a>
  <a target="_top" class="btn btn-just-icon btn-social-small btn-social-mail"
     href="mailto:adam@marczak.io">
    <i class="fa fa-envelope"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-facebook"
     href="https://www.facebook.com/MarczakIO/">
    <i class="fa fa-facebook"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-twitter"
     href="https://twitter.com/MarczakIO">
    <i class="fa fa-twitter"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-github"
     href="https://github.com/MarczakIO">
    <i class="fa fa-github"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-youtube"
     href="https://www.youtube.com/azure4everyone">
    <i class="fa fa-youtube"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-linkedin"
     href="https://www.linkedin.com/in/adam-marczak-96088929/">
    <i class="fa fa-linkedin"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-rss"
     href="https://marczak.io/index.xml">
    <i class="fa fa-rss"></i>
  </a>
</div>
            </div>
            &copy;<a href="/about" title="Adam Marczak" class="vcard author"><strong class="fn">Adam Marczak</strong></a> <a href="https://themeisle.com/themes/hestia/" target="_blank" rel="nofollow">Hestia Theme</a>
        </div>
    </div>
</footer>
    </div>
  </div>
  
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  
  <script>window.jQuery || document.write('<script src="https:\/\/marczak.io\/js\/jquery.js"><\/script>')</script>
  
  <script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <script>if(typeof($.fn.modal) === 'undefined') {document.write('<script src="https:\/\/marczak.io\/js\/bootstrap.min.js"><\/script>')}</script>
  
  <div id="bootstrapCssTest" class="hidden"></div>
  <script>
    $(function() {
      if ($('#bootstrapCssTest').is(':visible')) {
        $("head").prepend('<link rel="stylesheet" href="https:\/\/marczak.io\/css\/bootstrap.min.css">');
      }
    });
  </script>
  <script type="text/javascript" src="https://marczak.io/js/main.min.js?ver=1.16"></script>
</body>
</html>