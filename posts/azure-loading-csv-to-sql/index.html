<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en-us">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Quick, easy and cheap way to automate data loading from CSV file into Azure SQL | Marczak.IO | Adam Marczak</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/png" href="https://marczak.io/images/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="https://marczak.io/images/favicon-16x16.png" sizes="16x16" />
<link rel="apple-touch-icon-precomposed" href="https://marczak.io/images/iphone-icon.png"/>
<link rel="stylesheet" id="hestia_fonts-css" href="https://fonts.googleapis.com/css?family=Roboto%3A300%2C400%2C500%2C700%7CRoboto+Slab%3A400%2C700&amp;subset=latin%2Clatin-ext" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css" media="all">
<link href='https://marczak.io/css/hestia.min.css' rel="stylesheet" type="text/css" />
<link href='https://marczak.io/css/main.min.css?ver=1.21' rel='stylesheet' type="text/css" />

<meta name="description" content="Check out how to leverage Azure Blob Storage and Logic Apps for simple scenario of data loading from CSV into Azure SQL in less than 30 minutes and with almost no coding.">
<meta name="author" content="Adam Marczak">
<meta name="copyright" content="Adam Marczak">
<meta name="title" content="Quick, easy and cheap way to automate data loading from CSV file into Azure SQL | Marczak.IO | Adam Marczak">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="https://www.facebook.com/MarczakIO/">
<meta property="og:type" content="article">
<meta property="og:title" content="Quick, easy and cheap way to automate data loading from CSV file into Azure SQL">
<meta property="og:description" content="Check out how to leverage Azure Blob Storage and Logic Apps for simple scenario of data loading from CSV into Azure SQL in less than 30 minutes and with almost no coding.">
<meta property="og:url" content="https://marczak.io/posts/azure-loading-csv-to-sql/">
<meta property="og:site_name" content="Marczak.IO">
<meta property="og:image" content="https://marczak.io/images/azure-loading-csv-to-sql/splash.png">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@MarczakIO">
<meta name="twitter:title" content="Quick, easy and cheap way to automate data loading from CSV file into Azure SQL">
<meta name="twitter:description" content="Check out how to leverage Azure Blob Storage and Logic Apps for simple scenario of data loading from CSV into Azure SQL in less than 30 minutes and with almost no coding.">
<meta name="twitter:url" content="https://marczak.io/posts/azure-loading-csv-to-sql/">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106560028-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-106560028-1');
</script>
</head>
<body class="home blog">
  <div class="wrapper"><header class="header">
  <nav class="navbar navbar-default navbar-fixed-top  hestia_left">
    <div class="container">
      <div class="navbar-header">
        <div class="title-logo-wrapper">
          <a class="navbar-brand" href="/" title="Marczak.IO">
            <p>Marczak.IO</p>
          </a>
        </div>
      </div>
      <div id="main-navigation" class="navbar-custom">
        <div class="entry-social">
  <a target="_top" class="btn btn-just-icon btn-social btn-social-mail"
     href="mailto:adam@marczak.io">
    <i class="fa fa-envelope"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-facebook"
     href="https://www.facebook.com/MarczakIO/">
    <i class="fa fa-facebook"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-twitter"
     href="https://twitter.com/MarczakIO">
    <i class="fa fa-twitter"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-linkedin"
     href="https://www.linkedin.com/in/adam-marczak-96088929/">
    <i class="fa fa-linkedin"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social btn-social-youtube"
     href="https://www.youtube.com/azure4everyone">
    <i class="fa fa-youtube"></i>
  </a>
  <a target="_top" class="btn btn-friendly-site " 
      style=""
      href="https://azure4everyone.com">
      <img src="https://marczak.io/images/azure4everyone.svg">
      <span>Azure 4 Everyone</span>
  </a>
</div>
      </div>
    </div>
  </nav>
  <div id="primary" class="boxed-layout-header page-header header-small" data-parallax="active" style="margin-top: 50px;">
    <div class="container">
      <div class="row">
        <div class="col-md-10 col-md-offset-1 text-center">
          <h1 class="hestia-title">Quick, easy and cheap way to automate data loading from CSV file into Azure SQL</h1>
          
            <h4 class="author">
              Published by<a href="/about" title="Adam Marczak" class="vcard author"><strong class="fn">Adam Marczak</strong></a> on <time class="date updated published" datetime="2018-06-03 11:00:23 &#43;0200 CEST">Jun 3 2018</time>
            </h4>
           
        </div>
      </div>
    </div>
    <div class="header-filter" style="background-image: url('/images/background.jpg');background-color: #283743;"></div>
  </div>
</header>
    <div class="main main-raised">
      <div class="hestia-blogs">
        <div class="container">
          <div class="row">
<div class="col-md-9 single-posts-wrap">
    <article id="/posts/azure-loading-csv-to-sql/" class="article-section section-text"> 
<div class="lazy" style="max-height: 432px">
    <div style="padding-bottom:56.25%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/splash.png" src=""/> 
</div> <a target="_blank" 
   rel="tooltip" 
   class="btn btn-github"
   href="https://github.com/MarczakIO/Azure-SQL-CSV-Loading">
    <i class="fa fa-github"></i>
    Source Code
</a>
        <h2>Highlight</h2>
        <p>Check out how to leverage Azure Blob Storage and Logic Apps for simple scenario of data loading from CSV into Azure SQL in less than 30 minutes and with almost no coding.</p>

<h2 id="intro">Intro</h2>

<p>About any developer out there at some point or another had to automate ETL process for data loading. This article will present a fast and convinient way to create data loading workflow for CSVs using Azure SQL and blob storage.</p>

<h3 id="data-factory-is-also-an-option">Data Factory is also an option</h3>

<p>If you are interested in loading data, there is now alternative path available. On my channel I show introduction to Azure Data Factory in which I showcase the scenario of Blob Storage CSV to SQL loading. Everything just under 10 minutes. Feel free to check it out!</p>

<iframe class="youtube" frameborder="0" allowfullscreen src="https://www.youtube.com/embed/EpDkxTHAhOs"></iframe>

<h3 id="prerequisites">Prerequisites</h3>

<p>In order to execute this scenario a developer must have following tools</p>

<ol>
<li>Azure Subscription</li>
</ol>

<p><strong>That&rsquo;s it!</strong></p>

<h2 id="design">Design</h2>

<p>Preparation of design is a crucial setup in delivery of complete architecture. In this example, following design choices were made</p>

<ol>
<li><strong>Azure Blob Storage</strong> for purpose of uploading and storing input data files

<ol>
<li>Storage will have container called <strong>input</strong> which will store all unprocessed input files</li>
<li>Storage will have container called <strong>output</strong> where all processed files will be moved and their name will be changed to match date of processing</li>
</ol></li>
<li><strong>Azure Logic App</strong> which will be triggered where new file appears in input container of blob storage</li>
<li><strong>Azure SQL</strong> that will store data model, loading procedure and the data itself</li>
</ol>

<h3 id="process-flow">Process flow</h3>

<p>It only takes three very small components for this scenario to be implemented. With that said let&rsquo;s now discuss how will the process look like. Diagram below presents overall architecture of the solution.

<div class="lazy" style="max-height: 429px">
    <div style="padding-bottom:48.529411764705884%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/1.png" src=""/> 
</div>  </p>

<p>Diagram covers following high level steps</p>

<ol>
<li>Uploading CSV file to blob storage (be it via portal or automated way in future)</li>
<li>Triggering logic app whenever there is a new file in the storage</li>
<li>Logic app connects to SQL database and triggers data loading procedure</li>
<li>SQL database runs procedure which is using BULK INSERT command to connect to blob storage and load data</li>
<li>Logic app moves processed file to outputs on successful load</li>
</ol>

<h2 id="provisioning">Provisioning</h2>

<p>Log into <a href="https://portal.azure.com">Azure Portal</a> and start creating resources.</p>

<h3 id="resource-group">Resource Group</h3>

<ol>
<li>Click on &ldquo;+&rdquo; sign and type in <strong>Resource Group</strong> in Search window

<div class="lazy" style="max-height: 304px">
    <div style="padding-bottom:78.1491002570694%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/2.png" src=""/> 
</div>  </li>
<li>Click on the result and click on <strong>Create</strong> button</li>
<li>Give it a name and hit Create again

<div class="lazy" style="max-height: 282px">
    <div style="padding-bottom:76.01078167115902%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/3.png" src=""/> 
</div>  </li>
</ol>

<h3 id="blob-storage">Blob Storage</h3>

<ol>
<li>Click on &ldquo;+&rdquo; sign and type in <strong>Storage account</strong> in Search window

<div class="lazy" style="max-height: 103px">
    <div style="padding-bottom:30.116959064327485%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/4.png" src=""/> 
</div>  </li>
<li>Click on the result and click on <strong>Create</strong> button</li>
<li>Give it any name and leave everything else default. For the resource group select <strong>Use existing</strong> and select resource group from previous step

<div class="lazy" style="max-height: 87px">
    <div style="padding-bottom:25.58823529411765%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/5.png" src=""/> 
</div>  

<div class="lazy" style="max-height: 115px">
    <div style="padding-bottom:34.32835820895522%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/6.png" src=""/> 
</div>  </li>
<li>Hit Create (optionally select pin to dashboard before clicking)</li>
<li>When the resource is created go to its options and click on <strong>Containers</strong> blade

<div class="lazy" style="max-height: 206px">
    <div style="padding-bottom:78.03030303030303%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/7.png" src=""/> 
</div>  </li>
<li>Create two new private containers called <strong>input</strong> and <strong>output</strong>

<div class="lazy" style="max-height: 346px">
    <div style="padding-bottom:58.053691275167786%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/8.png" src=""/> 
</div>  </li>
</ol>

<h3 id="sql-server-database">SQL Server &amp; Database</h3>

<ol>
<li>Click on &ldquo;+&rdquo; sign and type in <strong>SQL Database</strong> in Search window

<div class="lazy" style="max-height: 108px">
    <div style="padding-bottom:31.123919308357348%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/9.png" src=""/> 
</div>  </li>
<li>Click on the result and click on <strong>Create</strong> button</li>
<li>Provide following values to the prompt

<div class="lazy" style="max-height: 635px">
    <div style="padding-bottom:173.97260273972603%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/10.png" src=""/> 
</div>  

<ol>
<li>Name for the database</li>
<li>Select existing resource group from previous step</li>
</ol></li>
<li>Since there is no SQL Server yet to host our database it is also required to create on at this point. For this click on the server and then <strong>Create a new server</strong> button.</li>
<li>Provide server name (this will be public DNS address of created server), admin login name and password

<div class="lazy" style="max-height: 469px">
    <div style="padding-bottom:126.75675675675676%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/11.png" src=""/> 
</div>  </li>
<li>Hit Select button</li>
<li>Hit Create (optionally select pin to dashboard before clicking)</li>
</ol>

<h3 id="logic-app">Logic App</h3>

<ol>
<li>Click on &ldquo;+&rdquo; sign and type in <strong>Logic App</strong> in Search window

<div class="lazy" style="max-height: 105px">
    <div style="padding-bottom:32.608695652173914%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/12.png" src=""/> 
</div>  </li>
<li>Click on the result and click on <strong>Create</strong> button</li>
<li>Give it a any name, for the resource group select <strong>Use existing</strong> and select resource group from previous step

<div class="lazy" style="max-height: 463px">
    <div style="padding-bottom:124.46236559139786%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/13.png" src=""/> 
</div>  </li>
<li>Hit Create (optionally select pin to dashboard before clicking)</li>
</ol>

<h2 id="development">Development</h2>

<p>I did mention previously that there will be almost no coding.</p>

<p>Before settings up database and loading procedure, a special access token must be generated so that SQL database can connect to blob storage and read files from there. This token is called <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-dotnet-shared-access-signature-part-1">SAS (Shared Access Signature) token</a>.</p>

<h3 id="blob-storage-1">Blob Storage</h3>

<ol>
<li>Navigate to previously created blob storage in Azure Portal</li>
<li>Select Shared Access Signature blade

<div class="lazy" style="max-height: 165px">
    <div style="padding-bottom:64.453125%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/16.png" src=""/> 
</div>  </li>
<li>Create SAS token with following settings

<div class="lazy" style="max-height: 632px">
    <div style="padding-bottom:74.79289940828403%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/17.png" src=""/> 
</div>  
Ensure that the <strong>End Date</strong> is far enough in future and replace this once it&rsquo;s expired. In production system an operations team can handle this or simply create a very small logic app that will generate new token and update the database credential.</li>
<li>Click <strong>Generate SAS and connection string</strong> and copy value of generated SAS token for further use. When this screen is closed a new token will have to be created if lost.

<div class="lazy" style="max-height: 219px">
    <div style="padding-bottom:25.795053003533567%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/18.png" src=""/> 
</div>  </li>
<li>Navigate to <strong>Containers</strong> blade</li>
<li>Click on the input container</li>
<li>Click on the properties blade

<div class="lazy" style="max-height: 291px">
    <div style="padding-bottom:127.07423580786026%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/19.png" src=""/> 
</div>  </li>
<li>Copy the URL value from the properties tab</li>
</ol>

<h3 id="sql-server-database-1">SQL Server &amp; Database</h3>

<p>Now finally for the database</p>

<ol>
<li>Navigate to previously created SQL database in Azure Portal</li>
<li>Click on Query Editor

<div class="lazy" style="max-height: 178px">
    <div style="padding-bottom:65.2014652014652%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/14.png" src=""/> 
</div>  
Optionally and recommended way to do this is via SQL Server Management Studio but for such simple scenario query editor is good enough.</li>
<li>Click on the Login button and provide previously set password</li>
<li>In the query window execute following SQL statement and replace unique string with secret key for the database. This creates master key which is used to encrypt all secrets in the database.
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="n">MASTER</span> <span class="k">KEY</span> <span class="n">ENCRYPTION</span> <span class="k">BY</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="s1">&#39;UNIQUE_STRING_HERE&#39;</span></code></pre></div>

<div class="lazy" style="max-height: 314px">
    <div style="padding-bottom:44.163150492264414%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/15.png" src=""/> 
</div>  </li>
<li>Create new credential object that will be used by the database to connect to blob storage. Replace SAS token value with value from previous steps. Note that there is no question mark at the begining of the secret
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">SCOPED</span> <span class="n">CREDENTIAL</span> <span class="n">BlobCredential</span>
<span class="k">WITH</span> <span class="k">IDENTITY</span> <span class="o">=</span> <span class="s1">&#39;SHARED ACCESS SIGNATURE&#39;</span><span class="p">,</span>
<span class="n">SECRET</span> <span class="o">=</span> <span class="s1">&#39;sv=SAS_TOKEN_HERE&#39;</span><span class="p">;</span></code></pre></div></li>
<li>Create new connection to blob with previous credentials
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">EXTERNAL</span> <span class="k">DATA</span> <span class="k">SOURCE</span> <span class="n">AzureBlob</span>
<span class="k">WITH</span> <span class="p">(</span> 
    <span class="k">TYPE</span>       <span class="o">=</span> <span class="n">BLOB_STORAGE</span><span class="p">,</span>
    <span class="k">LOCATION</span>   <span class="o">=</span> <span class="s1">&#39;https://marczakiocsvstorage.blob.core.windows.net/input&#39;</span><span class="p">,</span>
    <span class="n">CREDENTIAL</span> <span class="o">=</span> <span class="n">BlobCredential</span>
<span class="p">);</span></code></pre></div></li>
<li>In this example a CSV file with two columns ID and VALUE will be loaded for simplicity. So next step is to create table with those columns in the database using following SQL.
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">MyData</span> <span class="p">(</span>
    <span class="n">ID</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">VALUE</span> <span class="n">nvarchar</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
<span class="p">)</span></code></pre></div>
File will look like this and will be named <strong>input.csv</strong>
<div class="highlight"><pre class="chroma"><code class="language-csv" data-lang="csv">ID,VALUE
1,Adam
2,Tom
3,Max
4,LJ
5,Jason
6,Thomas
7,Piotr
8,Anna
9,Jessabelle</code></pre></div></li>
<li>Now the last step is to create a procedure which will load data from the input.csv file to MyData table.
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="n">LoadData</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>

<span class="k">DELETE</span> <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">MyData</span><span class="p">];</span>

<span class="n">BULK</span> <span class="k">INSERT</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">MyData</span><span class="p">]</span>
<span class="k">FROM</span> <span class="s1">&#39;input.csv&#39;</span>
<span class="k">WITH</span> <span class="p">(</span> 
    <span class="n">DATA_SOURCE</span> <span class="o">=</span> <span class="s1">&#39;AzureBlob&#39;</span><span class="p">,</span>
    <span class="n">FORMAT</span>      <span class="o">=</span> <span class="s1">&#39;CSV&#39;</span><span class="p">,</span>
    <span class="n">FIRSTROW</span>    <span class="o">=</span> <span class="mi">2</span>
<span class="p">);</span>

<span class="k">END</span></code></pre></div>
Few important things to note here

<ol>
<li>In proper scenario delete and insert should be encapsulated in a transaction which will roll back in case of errors during the load.</li>
<li>File name should be taken as parameter instead of static value and executed as dynamic SQL.</li>
</ol></li>
</ol>

<h3 id="logic-app-1">Logic App</h3>

<p>The best for last. Since the setup is now complete, creation of logic app is very pleasant.</p>

<ol>
<li>Navigate to previously created blob storage in Azure Portal</li>
<li>Select Edit button</li>
<li>Select Blank Logic App

<div class="lazy" style="max-height: 351px">
    <div style="padding-bottom:125.80645161290323%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/21.png" src=""/> 
</div>  </li>
<li>Type in Blob in the search window and select Blob Storage trigger that appears

<div class="lazy" style="max-height: 366px">
    <div style="padding-bottom:59.41558441558441%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/22.png" src=""/> 
</div>  </li>
<li>Define new blob connection and give it a name. Select storage account created earlier so that azure automatically saves connection info.

<div class="lazy" style="max-height: 284px">
    <div style="padding-bottom:46.17886178861789%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/23.png" src=""/> 
</div>  </li>
<li>Select input container

<div class="lazy" style="max-height: 229px">
    <div style="padding-bottom:29.171974522292995%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/24.png" src=""/> 
</div>  </li>
<li>Add new action

<div class="lazy" style="max-height: 124px">
    <div style="padding-bottom:40.1294498381877%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/25.png" src=""/> 
</div>  </li>
<li>Find SQL server and select Execute Stored Procedure in Actions Tab

<div class="lazy" style="max-height: 255px">
    <div style="padding-bottom:45.535714285714285%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/26.png" src=""/> 
</div>  </li>
<li>Define new connection to SQL server, select previously created database and provide credentials for connectivity

<div class="lazy" style="max-height: 435px">
    <div style="padding-bottom:76.44991212653778%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/27.png" src=""/> 
</div>  </li>
<li>Once connected select previously created procedure

<div class="lazy" style="max-height: 159px">
    <div style="padding-bottom:28.392857142857142%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/28.png" src=""/> 
</div>  </li>
<li>Add new action</li>
<li>Select Blob Storage <strong>Copy Blob</strong> Action - because there is no &lsquo;move&rsquo; action it is required for blob to be copied to new location and then for the old one to be removed.
In the source URL select <strong>Path</strong> object from the trigger step.

<div class="lazy" style="max-height: 539px">
    <div style="padding-bottom:58.842794759825324%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/29.png" src=""/> 
</div>  </li>
<li>Define destination path as conjunction of static path <strong>/output/</strong> and dynamic name of file from the trigger step <strong>DisplayName</strong> and static underscore <strong>_</strong> and finishing it with expression <strong>utcNow()</strong> so that uploading new input files will create different output files with the date suffix.

<div class="lazy" style="max-height: 294px">
    <div style="padding-bottom:29.080118694362017%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/30.png" src=""/> 
</div>  </li>
<li>Copy blob action should look like this.

<div class="lazy" style="max-height: 225px">
    <div style="padding-bottom:40.250447227191415%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/31.png" src=""/> 
</div>  </li>
<li>Add new action</li>
<li>Select blob <strong>delete blob</strong> action and add <strong>Path</strong> object from the trigger.

<div class="lazy" style="max-height: 171px">
    <div style="padding-bottom:30.922242314647377%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/32.png" src=""/> 
</div>  
<strong>WARNING</strong> Make sure to select Path from the trigger. If Path from Copy Blob action will be selected a newly created file will be removed.</li>
<li>Click save</li>
</ol>

<h2 id="test-it">Test it!</h2>

<ol>
<li>Navigate to blob storage input container</li>
<li>Click on the upload button and upload input.csv file

<div class="lazy" style="max-height: 349px">
    <div style="padding-bottom:35.25252525252525%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/20.png" src=""/> 
</div>  </li>
<li>Check if the logic app ran by going to logic app interface

<div class="lazy" style="max-height: 170px">
    <div style="padding-bottom:19.953051643192488%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/34.png" src=""/> 
</div>  </li>
<li>Check out the output container

<div class="lazy" style="max-height: 301px">
    <div style="padding-bottom:43.43434343434343%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/33.png" src=""/> 
</div>  </li>
<li>And finally check the data in the database from the query editor

<div class="lazy" style="max-height: 531px">
    <div style="padding-bottom:94.99105545617174%"></div>
    <img data-src="/images/azure-loading-csv-to-sql/35.png" src=""/> 
</div>  </li>
</ol>

<h2 id="what-s-next">What&rsquo;s next?</h2>

<p>There are of &lsquo;course some limitations and drawbacks to this design no doubt. With that said this is a good template to start from and expand.</p>

<ol>
<li>Read more about <a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-2017">BULK INSERT</a> and its bcp utility. For instance, to match columns and types using schema files.</li>
<li>Consider using <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/openrowset-transact-sql?view=sql-server-2017">OPENROWSET</a> when working with more complex data.</li>
<li>Change loading procedure to accept file name parameter so that input files on the blob do not have to follow naming convention, rather be in proper location. Logic apps allows for discovery of parameters so it is very easy to integrate.</li>
</ol><a target="_blank" 
   rel="tooltip" 
   class="btn btn-github"
   href="https://github.com/MarczakIO/Azure-SQL-CSV-Loading">
    <i class="fa fa-github"></i>
    Source Code
</a>
    </article>
    <div class="section-blog-info">
        <div class="row">
            <div class="col-md-12">
<div class="authorblock">
    <div class="row">
        <div class="col-sm-3">
            <div class="avatar"></div>
        </div>
        <div class="col-sm-9">
            <h4><b>Adam Marczak</b></h4>
            <p>Programmer, architect, trainer, blogger, evangelist are just few of many titles. What I really am, is just passionate technology enthusiast. I take great pleasure in learning new technologies and finding ways it can aid people every day. My latest passion is running <b><a href='https://www.youtube.com/azure4everyone'>Azure 4 Everyone</a></b> YouTube channel where I show that Azure is really for everyone!</p>
        </div>
    </div>
</div>
            </div>
        </div> 
        <div class="row">
            <div class="col-md-12 text-center">
                <h3 class="text-center">Did you enjoy the article?</h3>
            </div>
            <div class="col-md-6 text-center">
                <h4 class="">Share it!</h4><a target="_blank" 
   rel="tooltip" 
   data-original-title="Share on Facebook" 
   class="btn btn-just-icon btn-share btn-facebook"
   href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmarczak.io%2fposts%2fazure-loading-csv-to-sql%2f">
    <i class="fa fa-facebook"></i>
</a>
<a target="_blank" 
   rel="tooltip" 
   data-original-title="Share on Twitter" 
   class="btn btn-just-icon btn-share btn-twitter" 
   href="https://twitter.com/home?status=Quick%2c%20easy%20and%20cheap%20way%20to%20automate%20data%20loading%20from%20CSV%20file%20into%20Azure%20SQL - https%3a%2f%2fmarczak.io%2fposts%2fazure-loading-csv-to-sql%2f">
   <i class="fa fa-twitter"></i>
</a>
<a target="_blank" 
   rel="tooltip" 
   data-original-title="Share on Google+" 
   class="btn btn-just-icon btn-share btn-google" 
   href="https://plus.google.com/share?url=https%3a%2f%2fmarczak.io%2fposts%2fazure-loading-csv-to-sql%2f"><i 
   class="fa fa-google"></i>
</a>
            
            </div>
            <div class="col-md-6 text-center large">
                <h4 class="">More tagged posts</h4>
  <div class="tag-list">
    <a href="https://marczak.io/tags/azure" title="View all posts in Azure">
      <img src="https://marczak.io/images/tags/azure.svg" alt="Azure"/>
    </a>
    <a href="https://marczak.io/tags/logic-apps" title="View all posts in Logic Apps">
      <img src="https://marczak.io/images/tags/logic-apps.svg" alt="Logic Apps"/>
    </a>
    <a href="https://marczak.io/tags/sql" title="View all posts in SQL">
      <img src="https://marczak.io/images/tags/sql.svg" alt="SQL"/>
    </a>
  </div>
            </div>
        </div>
        <div class="row comments">
            <div class="col-md-12"><div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "https:\/\/marczak.io\/posts\/azure-loading-csv-to-sql\/"; 
this.page.identifier = "\/posts\/azure-loading-csv-to-sql\/";
};

(function() {
if (window.location.hostname == "localhost")return;
var d = document, s = d.createElement('script');
s.src = 'https://marczak-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
            </div>
        </div> 
    </div>
</div>
            <div class="col-md-3 blog-sidebar-wrapper">
              <aside id="secondary" class="blog-sidebar" role="complementary"><div id="recent-posts" class="recent-posts widget widget_recent_entries" style="float:left;margin-right:10px;">
<h5>Featured Videos</h5>
<div style="width:180px;margin-top:25px">
  <div class="tag-list">
    <img src="https://marczak.io/images/tags/azure.svg" alt="Azure"/>
    <img src="https://marczak.io/images/tags/youtube.svg" alt="YouTube"/>
  </div>
<div style="margin-top:10px;">
    <a href="https://youtu.be/GqpwiyYsNIw" > 
<div class="lazy" style="max-height: 416px">
    <div style="padding-bottom:56.21621621621622%"></div>
    <img data-src="/images/youtube/19-AzureCLI-Intro-v2-740.jpg" src=""/> 
</div> 
    </a>
</div>
<p style="font-weight:bold;margin: 3px 0 11px 0;">Azure CLI Intro</p>
</div>
<div style="width:180px;margin-top:25px">
  <div class="tag-list">
    <img src="https://marczak.io/images/tags/automation.svg" alt="Automation"/>
    <img src="https://marczak.io/images/tags/azure.svg" alt="Azure"/>
    <img src="https://marczak.io/images/tags/youtube.svg" alt="YouTube"/>
  </div>
<div style="margin-top:10px;">
    <a href="https://youtu.be/u6eR8yguVxE" > 
<div class="lazy" style="max-height: 416px">
    <div style="padding-bottom:56.21621621621622%"></div>
    <img data-src="/images/youtube/18-AzureAutomation-Intro-v2-740.jpg" src=""/> 
</div> 
    </a>
</div>
<p style="font-weight:bold;margin: 3px 0 11px 0;">Azure Automation Intro</p>
</div>
<div style="width:180px;margin-top:25px">
  <div class="tag-list">
    <img src="https://marczak.io/images/tags/azure.svg" alt="Azure"/>
    <img src="https://marczak.io/images/tags/data-factory.svg" alt="Data Factory"/>
    <img src="https://marczak.io/images/tags/youtube.svg" alt="YouTube"/>
  </div>
<div style="margin-top:10px;">
    <a href="https://youtu.be/AUpMCRggjIM" > 
<div class="lazy" style="max-height: 416px">
    <div style="padding-bottom:56.21621621621622%"></div>
    <img data-src="/images/youtube/17-AzureDataFactory-MappingDataFlows-v2-740.jpg" src=""/> 
</div> 
    </a>
</div>
<p style="font-weight:bold;margin: 3px 0 11px 0;">Azure Data Factory Mapping Data Flow</p>
</div>
</div><div id="recent-posts" class="recent-posts widget widget_recent_entries" style="float:left;margin-right:10px;">
</div><div id="recent-posts" class="recent-posts widget widget_recent_entries" style="float:left;max-width:180px;margin-right:30px;">
<h5>Recent Posts</h5>
<ul>
        <li><b class="list-header">2019 October</b></li>
        <li class="indented">
            <a href="/posts/2019/10/ea-consumption-automation-with-logic-apps/" title="Automating Enterprise Azure billing using Logic Apps for 0.03$/month" rel="bookmark">
                <b>25th </b>Automating Enterprise Azure billing using Logic Apps for 0.03$/month
            </a>
        </li>
        <li><b class="list-header">2019 August</b></li>
        <li class="indented">
            <a href="/posts/2019/08/logic-apps-obfuscation/" title="Enhancing Logic Apps security with obfuscation" rel="bookmark">
                <b>16th </b>Enhancing Logic Apps security with obfuscation
            </a>
        </li>
        <li class="indented">
            <a href="/posts/2019/08/secure-logic-app-with-api-management/" title="Securing Logic App with Azure AD authentication using API Management" rel="bookmark">
                <b>8th </b>Securing Logic App with Azure AD authentication using API Management
            </a>
        </li>
        <li><b class="list-header">2019 July</b></li>
        <li class="indented">
            <a href="/posts/2019/07/securing-websites-with-msi/" title="Securing Azure Services with Managed Identities" rel="bookmark">
                <b>19th </b>Securing Azure Services with Managed Identities
            </a>
        </li>
        <li class="indented">
            <a href="/posts/2019/07/azure-jumpstart/" title="Azure Jumpstart - how to learn, practice and certify in Azure" rel="bookmark">
                <b>8th </b>Azure Jumpstart - how to learn, practice and certify in Azure
            </a>
        </li>
</ul>
</div><div id="categories-3" class="widget widget_categories" style="float: left;">
  <h5>Tags</h5>
  <ul class="tag-list">
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/active-directory.svg" alt="Active Directory"/> 
        </div> 
        <a href="https://marczak.io/tags/active-directory">Active Directory (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/analysis-services.svg" alt="Analysis Services"/> 
        </div> 
        <a href="https://marczak.io/tags/analysis-services">Analysis Services (3)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/api-management.svg" alt="Api Management"/> 
        </div> 
        <a href="https://marczak.io/tags/api-management">Api Management (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/app-service.svg" alt="App Service"/> 
        </div> 
        <a href="https://marczak.io/tags/app-service">App Service (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/azure.svg" alt="Azure"/> 
        </div> 
        <a href="https://marczak.io/tags/azure">Azure (16)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/bot-service.svg" alt="Bot Service"/> 
        </div> 
        <a href="https://marczak.io/tags/bot-service">Bot Service (5)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/cognitive-services.svg" alt="Cognitive Services"/> 
        </div> 
        <a href="https://marczak.io/tags/cognitive-services">Cognitive Services (2)</a>
      </li>
      <li class="child"> 
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/luis.svg" alt="Luis"/> 
        </div> 
        <a href="https://marczak.io/tags/luis">Luis (1)</a>
      </li>
      <li class="child"> 
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/text-analytics.svg" alt="Text Analytics"/> 
        </div> 
        <a href="https://marczak.io/tags/text-analytics">Text Analytics (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/cosmos-db.svg" alt="Cosmos Db"/> 
        </div> 
        <a href="https://marczak.io/tags/cosmos-db">Cosmos Db (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/data-factory.svg" alt="Data Factory"/> 
        </div> 
        <a href="https://marczak.io/tags/data-factory">Data Factory (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/data-gateway.svg" alt="Data Gateway"/> 
        </div> 
        <a href="https://marczak.io/tags/data-gateway">Data Gateway (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/dotnet-core.svg" alt="Dotnet Core"/> 
        </div> 
        <a href="https://marczak.io/tags/dotnet-core">Dotnet Core (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/flow.svg" alt="Flow"/> 
        </div> 
        <a href="https://marczak.io/tags/flow">Flow (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/functions.svg" alt="Functions"/> 
        </div> 
        <a href="https://marczak.io/tags/functions">Functions (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/key-vault.svg" alt="Key Vault"/> 
        </div> 
        <a href="https://marczak.io/tags/key-vault">Key Vault (1)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/logic-apps.svg" alt="Logic Apps"/> 
        </div> 
        <a href="https://marczak.io/tags/logic-apps">Logic Apps (7)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/security.svg" alt="Security"/> 
        </div> 
        <a href="https://marczak.io/tags/security">Security (3)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/sql.svg" alt="Sql"/> 
        </div> 
        <a href="https://marczak.io/tags/sql">Sql (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/teams.svg" alt="Teams"/> 
        </div> 
        <a href="https://marczak.io/tags/teams">Teams (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/visual-studio.svg" alt="Visual Studio"/> 
        </div> 
        <a href="https://marczak.io/tags/visual-studio">Visual Studio (3)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/visual-studio-code.svg" alt="Visual Studio Code"/> 
        </div> 
        <a href="https://marczak.io/tags/visual-studio-code">Visual Studio Code (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/vue.js.svg" alt="Vue.js"/> 
        </div> 
        <a href="https://marczak.io/tags/vue.js">Vue.js (2)</a>
      </li>
      <li>
        <div class="lazy" style="width:30px;height:20px;float:left;">
          <img src="" data-src="https://marczak.io/images/tags/webpack.svg" alt="Webpack"/> 
        </div> 
        <a href="https://marczak.io/tags/webpack">Webpack (1)</a>
      </li>
  </ul>
</div>
              </aside>
            </div>
          </div>
        </div>
      </div>
<footer class="footer footer-black footer-big">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h5 class="connected-title">Stay Connected</h5>
                <div class="">
  <a target="_top" class="btn btn-just-icon btn-social-small btn-social-about"
     href="/about">
    <i class="fa fa-user"></i>
  </a>
  <a target="_top" class="btn btn-just-icon btn-social-small btn-social-mail"
     href="mailto:adam@marczak.io">
    <i class="fa fa-envelope"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-facebook"
     href="https://www.facebook.com/MarczakIO/">
    <i class="fa fa-facebook"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-twitter"
     href="https://twitter.com/MarczakIO">
    <i class="fa fa-twitter"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-github"
     href="https://github.com/MarczakIO">
    <i class="fa fa-github"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-youtube"
     href="https://www.youtube.com/azure4everyone">
    <i class="fa fa-youtube"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-linkedin"
     href="https://www.linkedin.com/in/adam-marczak-96088929/">
    <i class="fa fa-linkedin"></i>
  </a>
  <a target="_blank" class="btn btn-just-icon btn-social-small btn-social-rss"
     href="https://marczak.io/index.xml">
    <i class="fa fa-rss"></i>
  </a>
</div>
            </div>
            &copy;<a href="/about" title="Adam Marczak" class="vcard author"><strong class="fn">Adam Marczak</strong></a> <a href="https://themeisle.com/themes/hestia/" target="_blank" rel="nofollow">Hestia Theme</a>
        </div>
    </div>
</footer>
    </div>
  </div>
  
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  
  <script>window.jQuery || document.write('<script src="https:\/\/marczak.io\/js\/jquery.js"><\/script>')</script>
  
  <script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <script>if(typeof($.fn.modal) === 'undefined') {document.write('<script src="https:\/\/marczak.io\/js\/bootstrap.min.js"><\/script>')}</script>
  
  <div id="bootstrapCssTest" class="hidden"></div>
  <script>
    $(function() {
      if ($('#bootstrapCssTest').is(':visible')) {
        $("head").prepend('<link rel="stylesheet" href="https:\/\/marczak.io\/css\/bootstrap.min.css">');
      }
    });
  </script>
  <script type="text/javascript" src="https://marczak.io/js/main.min.js?ver=1.15"></script>
</body>
</html>